{
  "hash": "ea9a4021454796bf59a64a4b28083c62",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1: Geospatial Analytics for Social Good: Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar\"\nauthor: \"kai feng\"\ndate: \"Sep 2, 2024\"\ndate-modified: \"last-modified\"\nexecute:\n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n# Introduction\n\n**The Rise of Armed Conflict and the Potential of Geospatial Analytics**\n\n-   **Impact:** Millions of lives are shattered by armed conflict each year.\n\n-   **Trend:** Armed conflict has been on the rise since around 2012, reversing the decline from the 1990s and early 2000s.\n\n**Recent Major Conflicts:**\n\n1.  **Libya, Syria, and Yemen (post-2011):** Instabilities following the Arab uprisings.\n\n2.  **Sahel Region:** Crisis exacerbated by Libya's instability.\n\n3.  **Azerbaijan-Armenian War (2020):** Conflict over the Nagorno-Karabakh enclave.\n\n4.  **Ethiopia’s Tigray Conflict (2020):** Severe fighting in the northern region.\n\n5.  **Myanmar (2021):** Conflict following the military’s power grab.\n\n6.  **Russia-Ukraine War (2022):** Major assault by Russia on Ukraine.\n\n7.  **Sudan and Gaza (2023):** New devastating conflicts.\n\n-   **Current Situation:** The number of people affected—through death, displacement, or need for humanitarian aid—is higher than in decades.\n\n**This Geospatial Analytics will Focus on:**\n\n-   **Objective:** This study will use spatial point patterns analysis to explore the spatial and spatio-temporal distribution of armed conflict in Myanmar.\n\n-   **Potential:** Geospatial analytics offer tremendous potential to address complex societal problems, providing insights into the patterns and dynamics of conflict.\n\nSource: [10 Conflicts to Watch in 2024](https://www.crisisgroup.org/global/10-conflicts-watch-2024)\n\n<br/><br/>\n\n# 1.0 Setup\n\n### 1.1 **Installing R-Packages**\n\n::: panel-tabset\n## *Importing and Transforming Data*\n\n-   `sf`:\n\n    -   For handling spatial vector data and transforming it into simple features (`sf`) objects.\n\n    -   Functions like `st_read()` for importing spatial data and `st_transform()` for coordinate reference system transformations.\n\n-   `tidyverse`: For data manipulation and transformation, including functions for working with `tibble` data frames.\n\n-   `readr`: For reading in CSV or other text-based data files if needed.\n\n-   `dplyr`: provide data manipulation capabilities (eg. to group and summarize the relationships between these columns)\n\n## *Mapping display*\n\n-   `patchwork`: To arrange map layout\n\n## *Deriving Quarterly KDE Layers*\n\n-   `spatstat`: For kernel density estimation (KDE) and spatial point pattern analysis.\n\n-   `stars`: For working with raster data and creating raster-based KDE layers.\n\n-   `raster`: Additional functions for raster operations, if necessary.\n\n## *Performing 2nd-Order Spatial Point Patterns Analysis*\n\n-   `spatstat`: For analyzing second-order spatial point patterns, such as pair correlation functions.\n\n-   `ggplot2`: For visualizing the results of spatial analysis.\n\n-   `animation, png, magick`: For animation work\n\n## *Deriving Quarterly Spatio-Temporal KDE Layers*\n\n-   `spatstat`: For spatio-temporal point pattern analysis and creating spatio-temporal KDE layers.\n\n-   `stars`: For handling spatio-temporal raster data.\n\n## *Performing 2nd-Order Spatio-Temporal Point Patterns Analysis*\n\n-   `spatstat`: For advanced spatio-temporal analysis, including the study of second-order effects over time.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, sf, readr, spatstat, raster, ggstatsplot, ggplot2, tmap, dplyr, patchwork, animation, png, magick, osmdata, osrm, scales, MASS)\n```\n:::\n\n\n<br/><br/>\n\n### 1.2 **Data Acquisition**\n\nWe will be using 2 sets of data:\n\n::: panel-tabset\n## Armed Conflict Data\n\n-   **Source:** [Armed Conflict Location & Event Data](https://acleddata.com/) (ACLED). ACLED is an independent, impartial international non-profit organization that collects data on violent conflict and protests worldwide.\n\n-   **Coverage:** Myanmar, from January 2021 to June 2024.\n\n-   **Event Types:** Focus on at least four main event types:\n\n    -   Battles\n\n    -   Explosion/Remote Violence\n\n    -   Strategic Developments\n\n    -   Violence Against Civilians\n\n-   **Study Period:** Quarterly armed conflict events from January 2021 to June 2024.\n\n## Administrative Boundary Data\n\n-   **Source:** [Myanmar Information Management Unit](https://geonode.themimu.info/layers/?limit=100&offset=0) (MIMU).\n-   **National Boundaries**: To get an overview of conflict patterns across the entire country.\n-   **State and Region with Sub-region Boundaries**: For understanding conflict distribution across larger administrative divisions.\n:::\n\n<br/><br/>\n\n### 1.3 **Importing Geospatial Data into R**\n\n::: panel-tabset\n## Armed Conflict Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- read_csv(\"data/ACLED_Myanmar.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 51553 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n## Administrative Boundaries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnational_boundaries <- st_read(dsn = \"data/National_Boundaries\", layer=\"mmr_polbnda_adm0_250k_mimu_1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda_adm0_250k_mimu_1' from data source \n  `C:\\Users\\ngkng\\Desktop\\School\\Geo -Local\\Take-home_Ex\\Take-home_Ex01\\data\\National_Boundaries' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1 feature and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nstate_region_subregion_boundaries <- st_read(dsn = \"data/State_And_Region_With_Sub-regions_Boundaries\", layer=\"mmr_polbnda2_adm1_250k_mimu_1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda2_adm1_250k_mimu_1' from data source \n  `C:\\Users\\ngkng\\Desktop\\School\\Geo -Local\\Take-home_Ex\\Take-home_Ex01\\data\\State_And_Region_With_Sub-regions_Boundaries' \n  using driver `ESRI Shapefile'\nSimple feature collection with 18 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n:::\n\n<br/><br/>\n\n### 1.4 **Checking Geospatial Data**\n\n::: panel-tabset\n## Armed Conflict Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"spec_tbl_df\" \"tbl_df\"      \"tbl\"         \"data.frame\" \n```\n\n\n:::\n\n```{.r .cell-code}\nst_crs(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System: NA\n```\n\n\n:::\n:::\n\n\n::: callout-note\nSince\n\n-   Since the class of **acled_sf** != sf object\n-   Coordinate Reference System of **acled_sf** = NA\n\nwe have to transform it.\n:::\n\n## Administrative Boundaries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(national_boundaries)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sf\"         \"data.frame\"\n```\n\n\n:::\n\n```{.r .cell-code}\nst_crs(national_boundaries)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(state_region_subregion_boundaries)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sf\"         \"data.frame\"\n```\n\n\n:::\n\n```{.r .cell-code}\nst_crs(state_region_subregion_boundaries)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n\n\n:::\n:::\n\n\n::: callout-note\nSince Coordinate Reference System of\n\n-   **national_boundaries**\n-   **state_region_subregion_boundaries**\n\nis in 4326 (unit of measurement = degree), we have to transform it\n:::\n:::\n\n<br/><br/>\n\n### 1.5 **Understanding the data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select relevant columns and group by disorder_type, event_type, sub_event_type\ntype_of_conflict <- acled_sf %>%\n  dplyr::select(disorder_type, event_type, sub_event_type) %>%\n  group_by(disorder_type, event_type, sub_event_type) %>%\n  summarize(count = n(), .groups = 'drop')  # Count occurrences of each combination\nprint(type_of_conflict, n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 4\n   disorder_type                      event_type            sub_event_type count\n   <chr>                              <chr>                 <chr>          <int>\n 1 Demonstrations                     Protests              Peaceful prot…  8132\n 2 Demonstrations                     Protests              Protest with …   463\n 3 Demonstrations                     Riots                 Violent demon…    94\n 4 Political violence                 Battles               Armed clash    11770\n 5 Political violence                 Battles               Government re…     5\n 6 Political violence                 Battles               Non-state act…   274\n 7 Political violence                 Explosions/Remote vi… Air/drone str…  2646\n 8 Political violence                 Explosions/Remote vi… Chemical weap…     1\n 9 Political violence                 Explosions/Remote vi… Grenade          393\n10 Political violence                 Explosions/Remote vi… Remote explos…  5511\n11 Political violence                 Explosions/Remote vi… Shelling/arti…  3655\n12 Political violence                 Explosions/Remote vi… Suicide bomb       2\n13 Political violence                 Riots                 Mob violence      22\n14 Political violence                 Violence against civ… Abduction/for…   905\n15 Political violence                 Violence against civ… Attack          5257\n16 Political violence                 Violence against civ… Sexual violen…    63\n17 Political violence; Demonstrations Protests              Excessive for…   234\n18 Strategic developments             Strategic developmen… Agreement         10\n19 Strategic developments             Strategic developmen… Arrests         4833\n20 Strategic developments             Strategic developmen… Change to gro…  1346\n21 Strategic developments             Strategic developmen… Disrupted wea…   325\n22 Strategic developments             Strategic developmen… Headquarters …    67\n23 Strategic developments             Strategic developmen… Looting/prope…  4042\n24 Strategic developments             Strategic developmen… Non-violent t…    28\n25 Strategic developments             Strategic developmen… Other           1475\n```\n\n\n:::\n:::\n\n\n::: callout-note\n## Note!\n\nThe dataset includes non-conflict events such as:\n\n-   **\"Change to group/activity\"**\n\n-   **\"Agreement\"**\n\n-   **\"Headquarters or base established\"**\n\nAdditionally, it contains a sub-event category labeled **\"Other\"**. Including these non-conflict events under the general category of \"conflict nature\" may lead to biased or misleading interpretations. To ensure accurate and meaningful analysis, I recommend removing these non-conflict events from the dataset.\n:::\n\n<br/><br/>\n\n### 1.6 **Data Preparation and Wrangling**\n\n::: panel-tabset\n## Armed Conflict Data\n\n##### Convert Data Frame to `sf` Object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)\n\nclass(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sf\"         \"tbl_df\"     \"tbl\"        \"data.frame\"\n```\n\n\n:::\n:::\n\n\n##### Transform Coordinate Reference System\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  st_transform(crs = 32647)\n```\n:::\n\n\n##### Convert Date Column to Date Format\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  mutate(event_date = dmy(event_date))\n```\n:::\n\n\n##### Eliminating Columns not used for analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf[, !(names(acled_sf) %in% c(\"event_id_cnty\", \"time_precision\", \"inter1\", \"inter2\", \"notes\", \"tags\"))]\n```\n:::\n\n\n##### Preparing Data for Quarterly KDE Analysis\n\n1.  Create a Quarter Column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  mutate(quarter = paste0(\"Q\", quarter(event_date), \"-\", year(event_date)))\n```\n:::\n\n\n2.  Remove non-conflict data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnon_conflict_events <- c(\n  \"Change to group/activity\",\n  \"Agreement\",\n  \"Headquarters or base established\",\n  \"Other\"\n)\n\n# Filter out the non-conflict events from the dataset\nconflict_acled_sf_data <- acled_sf %>%\n  filter(!sub_event_type %in% non_conflict_events)\n```\n:::\n\n\n##### Adding a new analysis dimension: month\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_acled_sf_data <- conflict_acled_sf_data %>%\n  mutate(month = month(event_date))\n\nwrite_rds(conflict_acled_sf_data, \"data/rds/conflict_acled_sf_data.rds\")\n```\n:::\n\n\n## Administrative Boundaries\n\n##### Transform the Coordinate Reference System of these:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnational_boundaries <- national_boundaries %>%\n  st_transform(crs = 32647)\n\nstate_region_subregion_boundaries <- state_region_subregion_boundaries %>%\n  st_transform(crs = 32647)\n```\n:::\n\n\n##### Sample plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = state_region_subregion_boundaries) +\n  geom_sf() +\n  theme_minimal() +\n  labs(title = \"Map of Geometries\",\n       subtitle = \"Displaying multipolygon geometries\",\n       caption = \"Source: Example Data\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n:::\n\n<br/><br/>\n\n# 2.0 Exploratory Data Analysis\n\n### 2.1 Temporal Analysis: Frequency of Conflict Events Over Time\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(conflict_acled_sf_data, aes(x = event_date)) +\n  geom_histogram(binwidth = 30, fill = \"steelblue\", color = \"black\") +\n  labs(title = \"Conflict Events Over Time\", x = \"Date\", y = \"Number of Events\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### 2.2 Event Type Distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(conflict_acled_sf_data, aes(x = event_date, fill = event_type)) +\n  geom_histogram(binwidth = 30) +\n  labs(title = \"Event Types Over Time\", x = \"Date\", y = \"Number of Events\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n### 2.3 Spatial Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot a choropleth of the conflict events by year using ggplot2\nggplot() +\n  geom_sf(data = national_boundaries, fill = \"lightgrey\") +\n  geom_sf(data = conflict_acled_sf_data, aes(color = event_type), size = 0.1, alpha = 0.6) +\n  facet_wrap(~year, ncol = 4) +  # Facet by year with 4 columns\n  labs(title = \"Spatial Distribution of Conflict Events by Year\", color = \"Event Type\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\") + \n  guides(color = guide_legend(override.aes = list(size = 1)))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n## ![](images/clipboard-890644755.png){width=\"22\"}Insights\n\nFrom 2021 to 2024, the conflicts in Myanmar have escalated significantly, evolving from largely peaceful protests to increasingly violent confrontations and armed battles.\n:::\n\n### 2.4 Conflict Hotspots by state & region\n\n##### 2.4.1 Preparing the hotspots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ensure the CRS of both datasets match\nconflict_acled_sf_data <- st_transform(conflict_acled_sf_data, crs = st_crs(state_region_subregion_boundaries))\n\n# Perform spatial join to add state/region information to the conflict dataset\nacled_with_state_region <- st_join(conflict_acled_sf_data, state_region_subregion_boundaries, join = st_intersects)\n\n# Filter out rows where ST is NA before summarizing\nacled_with_state_region <- acled_with_state_region %>%\n  filter(!is.na(ST))\n\n# Group by state/region and summarize conflict data\nconflict_summary_by_state_region <- acled_with_state_region %>%\n  group_by(ST, event_type, year) %>%\n  summarise(\n    total_conflicts = n(),\n    total_fatalities = sum(fatalities, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n# Convert state boundaries to a regular data frame (non-spatial)\nstate_region_boundaries_df <- as.data.frame(state_region_subregion_boundaries)\n\n# Merge the summary data with the state boundaries data frame\nstate_region_boundaries_summary <- state_region_boundaries_df %>%\n  left_join(conflict_summary_by_state_region, by = c(\"ST\" = \"ST\"))\n\n# Convert back to an sf object with geometry\nstate_region_boundaries_summary <- st_as_sf(state_region_boundaries_summary, crs = st_crs(state_region_subregion_boundaries))\n```\n:::\n\n\n##### 2.4.2 Plot the Hotspots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Base map with state/region boundaries\nstate_region_hotspot_tm <- tm_shape(state_region_boundaries_summary) +\n  tm_polygons(col = \"lightgrey\", border.col = \"black\") +\n  \n  # Overlay conflict data\n  tm_shape(conflict_summary_by_state_region) +\n  tm_dots(\n    col = \"event_type\", \n    palette = \"viridis\", \n    size = \"total_conflicts\", \n    alpha = 0.6)  +\n  \n  # Layout adjustments\n  tm_layout(\n    frame = FALSE,  # Remove the frame around the plot\n    legend.outside = TRUE,  # Keep the legend outside\n    legend.outside.position = \"bottom\",  # Position the legend outside at the bottom\n    legend.outside.size = 0.1,  # Adjust the size of the outside legend (reduce if too large)\n  ) +\n  \n  # Faceting by state/region\n  tm_facets(\n    by = c(\"ST\"),\n    free.scales = FALSE  # Use a common scale across all facets\n  )\n\nprint(state_region_hotspot_tm)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-21-1.png){width=960}\n:::\n:::\n\n\n::: callout-note\n## ![](images/clipboard-890644755.png){width=\"22\"}Insights\n\nThis map illustrates conflict patterns across a four-year period, revealing significant regional variations. It highlights that certain states and regions experience relatively lower levels of conflict, indicating greater overall peace.\n\nConversely, other areas show higher concentrations of specific types of conflicts. This distribution helps identify regions with frequent conflict events and those more prone to particular conflict types, offering valuable insights into the geographical and thematic spread of conflicts.\n:::\n\n##### 2.4.3 Visualize by Event Type\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the conflict types\nconflict_types <- c(\"Battles\", \"Protests\", \"Strategic developments\", \"Explosions/Remote violence\", \"Riots\", \"Violence against civilians\")\n\n# Initialize an empty list to store summaries\nconflict_summaries <- list()\n\n# Loop through each conflict type and summarize the data\nfor (type in conflict_types) {\n  summary <- acled_with_state_region %>%\n    filter(event_type == type) %>%\n    group_by(ST) %>%\n    summarise(\n      total_events = n(),\n      .groups = 'drop'\n    )\n  \n  # Store the summary in the list with the conflict type as the key\n  conflict_summaries[[type]] <- summary\n}\n\n# Convert state boundaries to a regular data frame (non-spatial)\nstate_region_subregion_boundaries_df <- as.data.frame(state_region_subregion_boundaries)\n\n# Merge each summary with the state boundaries data frame\nregion_conflict_summaries <- lapply(conflict_summaries, function(summary) {\n  region_summary <- state_region_subregion_boundaries_df %>%\n    left_join(summary, by = \"ST\")\n  \n  # Convert back to an sf object with geometry\n  st_as_sf(region_summary, crs = st_crs(state_region_subregion_boundaries))\n})\n\n# Rename the list elements for clarity\nnames(region_conflict_summaries) <- conflict_types\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list to store plots\nplots <- list()\n\n# Loop through each conflict type to create a plot\nfor (type in conflict_types) {\n  plots[[type]] <- tm_shape(region_conflict_summaries[[type]]) +\n    tm_polygons(\n      col = \"total_events\", \n      palette = \"Reds\", \n      title = paste(\"Number of\", type),\n      border.col = \"black\",\n      style = \"quantile\"  # This divides the data into quantiles for better visualization\n    ) +\n    \n    tm_text(\n      text = \"ST\",  # Use the column name that contains the region names\n      size = 0.6,        # Adjust the size as needed\n      col = \"black\",     # Text color\n      shadow = TRUE,    # Optional: Add shadow to make text more readable\n      remove.overlap = TRUE  # Avoid text overlapping\n    ) +\n    \n    tm_layout(\n      frame = FALSE,  # Remove the frame around the plot\n      legend.outside = TRUE,  # Keep the legend outside\n      legend.outside.position = \"right\",  # Position the legend outside at the bottom\n      legend.outside.size = 0.4  # Adjust the size of the outside legend (reduce if too large)\n    ) +\n    \n    tm_legend(\n      position = c(\"right\", \"bottom\")  # Position the legend outside at the bottom\n    )\n}\n\n\n# Arrange all plots in a single view using tm_arrange\ncombined_plot <- tmap_arrange(plots, ncol = 2, nrow = 3, \n                             legend.position = c(\"right\", \"bottom\"), \n                             legend.outside = TRUE)\n\n# Print the combined plot\nprint(combined_plot)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-23-1.png){width=960}\n:::\n:::\n\n\n<br/><br/>\n\n# 3.0 Deriving Quarterly KDE layers\n\n**Kernel Density Estimation (KDE)** provides a comprehensive view of where conflicts are occurring by visualizing the density of events across different quarters. By analyzing KDE on a quarterly basis, we can identify areas with high conflict intensity and gain insights into how the distribution of conflicts evolves over time. This approach helps in understanding temporal patterns and hotspots, offering a more detailed perspective on conflict dynamics.\n\nFor quarterly KDE layers:\n\n-   Subset data by quarter and compute KDE for each subset using `spatstat`\n\n::: callout-note\n## Note on Handling Duplicate Points\n\n**Duplicate points are removed in the analysis to avoid artificially inflating the density estimate.** Including duplicates could lead to an exaggerated representation of conflict hotspots, as each duplicate would incorrectly suggest multiple occurrences of the same event. By removing duplicates, we ensure that the Kernel Density Estimation (KDE) reflects the true intensity and distribution of distinct armed conflict events, providing a more accurate and reliable identification of hotspots.\n:::\n\n### 1. Create a list to store KDE for each quarter\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_list <- list()\n```\n:::\n\n\n### 2. Get Unique Quarters\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarters <- unique(conflict_acled_sf_data$quarter)\n```\n:::\n\n\n### 3. Perform Kernel Density Estimation (KDE)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboundary_window <- as.owin(national_boundaries)\n\n# Loop over each quarter to process data\nfor (q in quarters) {\n  \n  # Filter the dataset for the current quarter\n  quarter_data <- conflict_acled_sf_data %>%\n    filter(quarter == q)\n  \n  # Remove duplicates\n  coords <- st_coordinates(st_geometry(quarter_data))\n  if (any(duplicated(coords))) {\n    quarter_data <- quarter_data %>%\n      distinct(st_coordinates(st_geometry(.)), .keep_all = TRUE)\n  }\n  \n  # Convert the filtered data to a spatial point pattern (ppp object)\n  quarter_ppp <- as.ppp(st_geometry(quarter_data), W = boundary_window)\n  \n  # Perform Kernel Density Estimation (KDE)\n  kde <- density(quarter_ppp, sigma = 0.1)  # Adjust sigma as needed for smoothness\n  \n  # Store KDE in the list\n  kde_list[[q]] <- kde\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 2 points were rejected as lying outside the specified window\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 1 point was rejected as lying outside the specified window\nWarning: 1 point was rejected as lying outside the specified window\nWarning: 1 point was rejected as lying outside the specified window\n```\n\n\n:::\n:::\n\n\n### 4. Plot the KDE for Each Quarter\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfcol=c(5, 3))\n# Plot the KDEs for all quarters\nfor (q in quarters) {\n  if (!is.null(kde_list[[q]])) {\n    plot(kde_list[[q]], main = paste(\"KDE for\", q))\n  } else {\n    print(paste(\"No KDE available for quarter:\", q))\n  }\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png){width=960}\n:::\n:::\n\n\n# 3.0 Performing 2nd-Order Spatial Point Patterns Analysis\n\nNow, we will explore how armed conflict events are distributed and related.\n\n**Ripley’s K-function** is a useful tool for detecting whether events are clustered or spread out. It measures how the density of events changes with distance, helping to identify clustering or dispersion.\n\n**Whereas G-Function** examine the nearest-neighbor distances and understand how far apart the nearest events are.\n\n**F-Function** analyze the distribution of distances from a randomly chosen location to the nearest event\n\n#### **Computing K-Function Estimation**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Initialize list to store K-function results\nkfunction_list <- list()\n\n# Get unique quarters from the dataset\nquarters <- unique(conflict_acled_sf_data$quarter)\n\n# Loop over each quarter to compute K-function\nfor (q in quarters) {\n  \n  # Filter the dataset for the current quarter\n  quarter_data <- conflict_acled_sf_data %>%\n    filter(quarter == q)\n  \n  # Remove duplicates\n  coords <- st_coordinates(st_geometry(quarter_data))\n  if (any(duplicated(coords))) {\n    quarter_data <- quarter_data %>%\n      distinct(st_coordinates(st_geometry(.)), .keep_all = TRUE)\n  }\n  \n  # Convert the filtered data to a spatial point pattern (ppp object)\n  quarter_ppp <- as.ppp(st_geometry(quarter_data), W = as.owin(national_boundaries))\n  \n  # Compute the K-function\n  kfunction <- Kest(quarter_ppp, correction = \"border\")\n  \n  # Store the K-function in the list\n  kfunction_list[[q]] <- kfunction\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 2 points were rejected as lying outside the specified window\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 1 point was rejected as lying outside the specified window\nWarning: 1 point was rejected as lying outside the specified window\nWarning: 1 point was rejected as lying outside the specified window\n```\n\n\n:::\n:::\n\n\n::: callout-note\n## Note\n\nRipley’s Correction: Provides a more sophisticated adjustment for edge effects by modifying the expected K-function, leading to potentially more accurate results in large areas. Border Correction: Simplifies the adjustment by extending the study area and is less computationally intensive but might be less accurate in areas with significant boundary effects.\n\nWe use correction = \"border\" rather than correction = \"Ripley\" for our analysis. Our primary goal is to observe the general distribution of conflict hotspots, which will guide more detailed follow-up studies. Given that our focus is on broad patterns rather than precise details, the simpler and less computationally intensive border correction is sufficient. While Ripley's correction offers more accuracy by adjusting for edge effects, it requires more computational resources and time, which we can afford to forego for this preliminary analysis.\n:::\n\n#### Plotting K-Function\n\n**Interpretation**:\n\n-   **Above the theoretical line**: Indicates clustering of points.\n\n-   **Below the theoretical line**: Suggests dispersion or regularity.\n\n-   **Close to the line**: Implies a random distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfcol=c(5, 3))\n# Plot the K-functions for all quarters\nfor (q in quarters) {\n  if (!is.null(kfunction_list[[q]])) {\n    # Plot K-function\n    plot(kfunction_list[[q]], . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\", main = paste(\"K-function for Quarter\", q))\n  } else {\n    print(paste(\"No K-function available for quarter:\", q))\n  }\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-29-1.png){width=960}\n:::\n:::\n\n\n# 4.0 Deriving Quarterly spatio-temporal KDE layers\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the output directory for saving KDE plots\noutput_dir <- \"quarterly_kde_images\"\ndir.create(output_dir, showWarnings = FALSE)\n\n# Define a list to hold filenames of saved KDE plots\nsaved_files <- list()\n\n# Define a function to create and save KDE plots for each quarter\nsave_kde_plot <- function(kde, quarter, output_dir) {\n  # Create a file path for the KDE image\n  file_name <- file.path(output_dir, paste0(\"quarterly_kde_\", gsub(\" \", \"_\", quarter), \".png\"))\n  \n  # Open a PNG device to save the plot\n  png(file_name, width = 800, height = 800)\n  \n  # Plot KDE\n  plot(kde, main = paste(\"Spatio-Temporal KDE for\", quarter))\n  \n  # Close the PNG device\n  dev.off()\n  \n  # Print confirmation message\n  print(paste(\"Saved:\", file_name))\n  \n  # Return the filename of the saved plot\n  return(file_name)\n}\n\n# Generate and save KDE plots for each quarter in reverse chronological order\nfor (q in rev(quarters)) {\n  if (!is.null(kde_list[[q]])) {\n    file_name <- save_kde_plot(kde_list[[q]], q, output_dir)\n    saved_files <- append(saved_files, file_name)\n  } else {\n    print(paste(\"No KDE data available for quarter:\", q))\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q1-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q2-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q3-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q4-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q1-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q2-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q3-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q4-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q1-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q2-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q3-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q4-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q1-2024.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kde_images/quarterly_kde_Q2-2024.png\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load saved images and combine them into an animated GIF\nimages <- lapply(saved_files, image_read)\n\n# Create an animation from the KDE images\nanimation <- image_animate(image_join(images), fps = 1)\n\n# Define the path for the GIF animation\ngif_path <- \"spatio_temporal_kde_animation.gif\"\n\n# Save the animation as a GIF file\nimage_write(animation, path = gif_path)\n\n# Print confirmation that the GIF was saved\nprint(\"Spatio-temporal KDE animation saved as spatio_temporal_kde_animation.gif\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Spatio-temporal KDE animation saved as spatio_temporal_kde_animation.gif\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Display the GIF using magick\ngif_image <- image_read(gif_path)\nprint(gif_image) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 GIF      800    800 sRGB       FALSE        0 72x72  \n 2 GIF      800    800 sRGB       FALSE        0 72x72  \n 3 GIF      800    800 sRGB       FALSE        0 72x72  \n 4 GIF      800    800 sRGB       FALSE        0 72x72  \n 5 GIF      800    800 sRGB       FALSE        0 72x72  \n 6 GIF      800    800 sRGB       FALSE        0 72x72  \n 7 GIF      800    800 sRGB       FALSE        0 72x72  \n 8 GIF      800    800 sRGB       FALSE        0 72x72  \n 9 GIF      800    800 sRGB       FALSE        0 72x72  \n10 GIF      800    800 sRGB       FALSE        0 72x72  \n11 GIF      800    800 sRGB       FALSE        0 72x72  \n12 GIF      800    800 sRGB       FALSE        0 72x72  \n13 GIF      800    800 sRGB       FALSE        0 72x72  \n14 GIF      800    800 sRGB       FALSE        0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-31-1.gif)\n:::\n:::\n\n\n# 5.0 Performing 2nd-Order Spatio-temporal Point Patterns\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the output directory for saving K-function plots\nkfunction_output_dir <- \"quarterly_kfunction_images\"\ndir.create(kfunction_output_dir, showWarnings = FALSE)\n\n# Define a list to hold filenames of saved K-function plots\nkfunction_files <- list()\n\n# Define a function to create and save K-function plots for each quarter\nsave_kfunction_plot <- function(kfunction, quarter, output_dir) {\n  # Create a file path for the K-function image\n  file_name <- file.path(output_dir, paste0(\"quarterly_kfunction_\", gsub(\" \", \"_\", quarter), \".png\"))\n  \n  # Open a PNG device to save the plot\n  png(file_name, width = 800, height = 800)\n  \n  # Plot K-function\n  plot(kfunction, . -r ~ r, ylab = \"K(d) - d\", xlab = \"d (m)\", main = paste(\"Ripley's K-function for Quarter\", quarter))\n  \n  # Close the PNG device\n  dev.off()\n  \n  # Print confirmation message\n  print(paste(\"Saved:\", file_name))\n  \n  # Return the filename of the saved plot\n  return(file_name)\n}\n\n# Save K-function plots for each quarter\nfor (q in rev(quarters)) {\n  if (!is.null(kfunction_list[[q]])) {\n    file_name <- save_kfunction_plot(kfunction_list[[q]], q, kfunction_output_dir)\n    kfunction_files <- append(kfunction_files, file_name)\n  } else {\n    print(paste(\"No K-function data available for quarter:\", q))\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q1-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q2-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q3-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q4-2021.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q1-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q2-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q3-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q4-2022.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q1-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q2-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q3-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q4-2023.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q1-2024.png\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Saved: quarterly_kfunction_images/quarterly_kfunction_Q2-2024.png\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load saved images and combine them into an animated GIF\nkfunction_images <- lapply(kfunction_files, image_read)\n\n# Create an animation from the K-function images\nkfunction_animation <- image_animate(image_join(kfunction_images), fps = 1)\n\n# Define the path for the GIF animation\nkfunction_gif_path <- \"spatio_temporal_kfunction_animation.gif\"\n\n# Save the animation as a GIF file\nimage_write(kfunction_animation, path = kfunction_gif_path)\n\n# Print confirmation that the GIF was saved\nprint(\"Ripley's K-function animation saved as spatio_temporal_kfunction_animation.gif\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Ripley's K-function animation saved as spatio_temporal_kfunction_animation.gif\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Display the GIF using magick\nkfunction_gif_image <- image_read(kfunction_gif_path)\nprint(kfunction_gif_image)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 GIF      800    800 sRGB       FALSE        0 72x72  \n 2 GIF      800    800 sRGB       FALSE        0 72x72  \n 3 GIF      800    800 sRGB       FALSE        0 72x72  \n 4 GIF      800    800 sRGB       FALSE        0 72x72  \n 5 GIF      800    800 sRGB       FALSE        0 72x72  \n 6 GIF      800    800 sRGB       FALSE        0 72x72  \n 7 GIF      800    800 sRGB       FALSE        0 72x72  \n 8 GIF      800    800 sRGB       FALSE        0 72x72  \n 9 GIF      800    800 sRGB       FALSE        0 72x72  \n10 GIF      800    800 sRGB       FALSE        0 72x72  \n11 GIF      800    800 sRGB       FALSE        0 72x72  \n12 GIF      800    800 sRGB       FALSE        0 72x72  \n13 GIF      800    800 sRGB       FALSE        0 72x72  \n14 GIF      800    800 sRGB       FALSE        0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-33-1.gif)\n:::\n:::\n\n\n<br/><br/>\n\n# 6.0 Analysis using Openstreetmap of Myanmar\n\nWe can make use of OpenStreetMap(OSM) data to create a vivid picture of how armed conflict affects not just the landscape but also the lives and infrastructure essential for the population. From identifying hotspots to understanding the disruption of critical services, here’s how we can delve deeper into the conflict’s impact.\n\n### 6.1 Download OSM Data\n\n::: panel-tabset\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define list of states in Myanmar\nstates <- c(\"Ayeyarwady\", \"Bago\", \"Kachin\", \"Kayah\", \"Kayin\", \n            \"Magway\", \"Mandalay\", \"Mon\", \"Rakhine\", \"Shan\", \"Tanintharyi\", \"Yangon\")\n\n# Define amenities to retrieve\namenities <- c(\"hospital\", \"school\", \"police\", \"fire_station\", \"pharmacy\")\n\n# Initialize empty lists to store data\nall_amenities <- list()\nall_roads <- list()\n\n# Loop through each state\nfor (state in states) {\n  # Define bounding box for each state\n  bbox <- getbb(state)\n  \n  # Initialize an empty list to store amenities data for the current state\n  state_amenities <- list()\n  \n  # Loop through each amenity and retrieve the data\n  for (amenity in amenities) {\n    query <- opq(bbox = bbox) %>%\n             add_osm_feature(key = \"amenity\", value = amenity)\n    amenity_data <- osmdata_sf(query)\n    state_amenities[[amenity]] <- amenity_data$osm_points  # Store points\n  }\n  \n  # Combine all amenities into one spatial object for the current state\n  state_amenities_sf <- bind_rows(state_amenities)\n  state_amenities_sf <- state_amenities_sf[!is.na(state_amenities_sf$amenity), ]\n  \n  # Download road data for the current state\n  roads_query <- opq(bbox = bbox, timeout = 180) %>%\n                 add_osm_feature(key = \"highway\", value = \"primary\")\n  roads_data <- osmdata_sf(roads_query)\n  \n  # Store data in lists\n  all_amenities[[state]] <- state_amenities_sf\n  all_roads[[state]] <- roads_data$osm_lines\n  \n  # Save the data to files if needed\n  write_rds(state_amenities_sf, paste0(\"data/rds/\", tolower(state), \"_amenities.rds\"))\n  write_rds(roads_data, paste0(\"data/rds/\", tolower(state), \"_roads.rds\"))\n}\n```\n:::\n\n:::\n\n::: panel-tabset\n## Mapping Conflict Hotspots and Assessing Infrastructure Risks\n\nConflicts are rarely isolated events. They often impact critical infrastructures such as roads, hospitals, and schools. By mapping these infrastructures and overlaying conflict event data, we can identify areas at risk and evaluate the potential disruption to civilian services.\n\n-   **Proximity Analysis to Critical Infrastructure:**\\\n    Using OSM, we can pinpoint key infrastructure locations. For instance, if we map hospitals and schools across conflict-affected regions, we can then measure how close these events are to such critical points. This helps us identify high-risk zones where services are most likely to be disrupted, putting civilian lives and wellbeing at immediate risk.\n\n-   **Assessing Road and Transportation Disruption:**\\\n    Roads are the lifelines that connect people to essential services and humanitarian aid. By mapping major highways and railways, we can overlay conflict data to see which routes are most affected. Visualizing these disrupted routes can highlight areas where civilian movement is restricted, potentially hindering access to safety or relief.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_acled_sf_data <- read_rds(\"data/rds/conflict_acled_sf_data.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ntmap mode set to plotting\n```\n\n\n:::\n\n```{.r .cell-code}\n# List of all states in Myanmar\nstates <- c(\"Ayeyarwady\", \"Kayah\", \"Kayin\", \n            \"Magway\", \"Rakhine\", \"Tanintharyi\", \"Yangon\")\n\n# Initialize an empty list to store the maps\nmaps <- list()\n\n# Loop through each state to create maps\nfor (state in states) {\n  # Construct file paths for roads and amenities data\n  road_data_path <- paste0(\"data/rds/\", tolower(state), \"_roads.rds\")\n  amenity_data_path <- paste0(\"data/rds/\", tolower(state), \"_amenities.rds\")\n  \n  # Check if the files exist before reading\n  if (file.exists(road_data_path) && file.exists(amenity_data_path)) {\n    # Read road and amenities data for the current state\n    roads <- read_rds(road_data_path)\n    amenities <- read_rds(amenity_data_path)\n    \n    # Check that the road and amenities data have valid geometry\n    if (!is.null(roads$osm_lines) && !is.null(amenities)) {\n      roads_sf <- roads$osm_lines\n      amenities_sf <- amenities\n      \n      # Set conflict dot size based on the state\n      conflict_dot_size <- ifelse(state %in% c(\"Ayeyarwady\", \"Magway\"), 0.01, 0.1)\n      \n      # Create the map for the current state\n      state_map <- tm_shape(roads_sf) +\n        tm_lines(col = \"gray\", lwd = 0.5) +  # Add lines for roads\n        tm_shape(amenities_sf) +  \n        tm_symbols(col = \"amenity\", size = 0.01, shape = 21,\n                   palette = c(\"yellow\", \"blue\", \"green\", \"orange\", \"purple\"),\n                   title.col = \"Amenity Type\") +  # Color by amenity type\n        tm_shape(conflict_acled_sf_data) +  # Ensure this is defined correctly\n        tm_symbols(size = conflict_dot_size, col = \"red\", shape = 3, style = \"cont\") +\n        tm_layout(title = paste(\"Key Amenities and Conflict Events in\", state),\n                  title.position = c(\"center\", \"top\"),\n                  legend.text.size = 0.8,\n                  legend.title.size = 1.0,\n                  title.size = 1.0,\n                  title.color = \"black\",\n                  legend.position = c(\"right\", \"bottom\"))\n      \n      # Store the map in the list\n      maps[[state]] <- state_map\n    } else {\n      warning(paste(\"Invalid or empty data for state:\", state))\n    }\n  } else {\n    warning(paste(\"Files not found for state:\", state))\n  }\n}\n\nif (length(maps) > 0) {\n  # Arrange and display all maps in a grid format\n  do.call(tmap_arrange, c(maps, list(ncol = 2)))\n} else {\n  warning(\"No maps available to display.\")\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-1.png){width=960}\n:::\n:::\n\n\n::: callout-note\nNotably, conflict events tend to be concentrated around major road networks, indicating potential hotspots of unrest and activity.\n:::\n:::\n\n# Learnings/Reflections\n\n::: panel-tabset\n## Learnings\n\n-   **Importance of Data Storage**: To speed up my project, I used the `write_rds` method to save downloaded files, especially from OpenStreetMap (OSM). This helps me avoid repeated downloads.\n\n-   **Choosing Visualization Tools**: I found that `tmap` is easier for users to understand when visualizing maps compared to `ggplot2`, which can be more complex, especially for global views.\n\n-   **KDE Selection**: The choice of bandwidth for Kernel Density Estimation (KDE) depends on the specific needs of the analysis.\n\n## Reflections\n\nThis exercise has been both insightful and challenging. I tried various plotting methods, experiencing both successes and failures. Some results met my expectations, while others revealed new insights that encouraged me to dig deeper.\n\nI've not only improved my technical skills but also gained a greater understanding of the ethical aspects of data representation. Each map I create tells a story of resilience and struggle. Merging data, cleaning it, and presenting it with `ggplot2` and `tmap` has shown me how important it is to communicate clearly and accurately.\n:::\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}