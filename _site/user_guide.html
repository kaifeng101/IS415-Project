<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kai Feng &amp; Edwin">

<title>Vietnam PCI Influence Analysis - User Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Vietnam PCI Influence Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./aboutus.html"> 
<span class="menu-text">About Us</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./project.html"> 
<span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./poster.html"> 
<span class="menu-text">Poster</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./user_guide.html" aria-current="page"> 
<span class="menu-text">User Guide</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pci-spatial-pattern-analysis-and-hotspots-analysis" id="toc-pci-spatial-pattern-analysis-and-hotspots-analysis" class="nav-link active" data-scroll-target="#pci-spatial-pattern-analysis-and-hotspots-analysis"><strong>PCI Spatial Pattern Analysis and Hotspots Analysis</strong></a></li>
  <li><a href="#fdi-spatial-pattern-analysis-and-hotspots-analysis" id="toc-fdi-spatial-pattern-analysis-and-hotspots-analysis" class="nav-link" data-scroll-target="#fdi-spatial-pattern-analysis-and-hotspots-analysis"><strong>FDI Spatial Pattern Analysis and Hotspots Analysis</strong></a></li>
  <li><a href="#global-explanatory-model" id="toc-global-explanatory-model" class="nav-link" data-scroll-target="#global-explanatory-model"><strong>Global Explanatory Model</strong></a></li>
  <li><a href="#local-explanatory-model" id="toc-local-explanatory-model" class="nav-link" data-scroll-target="#local-explanatory-model"><strong>Local Explanatory Model</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">User Guide</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kai Feng &amp; Edwin </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><br></p>
<section id="pci-spatial-pattern-analysis-and-hotspots-analysis" class="level2">
<h2 class="anchored" data-anchor-id="pci-spatial-pattern-analysis-and-hotspots-analysis"><strong>PCI Spatial Pattern Analysis and Hotspots Analysis</strong></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Local Moran of PCI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Gi Hotspot Analysis of PCI*</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Emerging Hotspot Analysis of PCI</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>This section displays the LISA map, which highlights local clusters and spatial outliers based on Local Moran’s I statistic.</p>
<ol type="1">
<li><p><strong>Mapping Variable (Year)</strong>: Select the PCI year to analyze.</p>
<ul>
<li><p>Options are dynamically populated based on available data</p>
<ul>
<li>Y2012-Y2022</li>
</ul></li>
</ul></li>
<li><p><strong>Contiguity Method</strong>: Choose the spatial contiguity method.</p>
<ul>
<li><p>Options: <code>Queen</code> (default) or <code>Rook</code>.</p></li>
<li><p>“Queen” considers all surrounding areas as neighbors, while “Rook” only considers those sharing borders. Selecting the appropriate method affects which areas are considered spatially related, impacting the detection of clusters or patterns.</p></li>
</ul></li>
<li><p><strong>Spatial Weights Style</strong>: Select a weighting style for spatial association.</p>
<ul>
<li><p>Options: <code>W</code> (Row standardized), <code>B</code> (Binary), <code>C</code> (Globally standardized), <code>U</code> (C / number of neighbors), <code>minmax</code>, <code>S</code> (Variance).</p></li>
<li><p>This setting ensures that neighboring areas are weighted consistently, making the spatial correlation measures more meaningful and comparable across regions.</p></li>
</ul></li>
<li><p><strong>Number of Simulations</strong>: Set the number of simulations for significance testing (between 99 and 499).</p>
<ul>
<li>Users can adjust this based on the desired balance between accuracy and computational time.</li>
</ul></li>
<li><p><strong>Confidence Level</strong>: Select the confidence level for the LISA significance results.</p>
<ul>
<li><p>Options: 95% (0.05) or 99% (0.01).</p></li>
<li><p>A higher confidence level (e.g., 99%) reduces the chance of false positives, ensuring the detected patterns are statistically reliable.</p></li>
</ul></li>
<li><p><strong>LISA Classification</strong>: Select a classification method for the LISA clusters.</p>
<ul>
<li><p>Options: <code>mean</code>, <code>median</code>, <code>pysal</code>.</p></li>
<li><p>This affects the interpretation of clusters (e.g., high-high or low-low areas) and helps customize the analysis to specific policy or research needs.</p></li>
</ul></li>
<li><p><strong>Local Moran’s Statistic</strong>: Choose the type of Local Moran’s statistic to display.</p>
<ul>
<li>Options: <code>local moran(ii)</code>, <code>expectation(eii)</code>, <code>variance(var_ii)</code>, <code>std deviation(z_ii)</code>, <code>P-value</code></li>
</ul></li>
</ol>
<p><img src="images/photo_2024-11-13_21-12-31.jpg" class="img-fluid" width="415"></p>
<p>The Main Panel displays the results based on the selected calibration inputs:</p>
<p><strong>Local Moran of PCI</strong>: The LISA map shows spatial clusters of similar PCI levels and outliers, indicating local dependencies or deviations.</p>
<p><img src="images/clipboard-3822262858.png" class="img-fluid"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>In this section, users can view the Gi* hotspot map, which identifies spatial clusters of high and low PCI values.</p>
<ol type="1">
<li><p><strong>Mapping Variable (Year)</strong>: Select the PCI year to analyze.</p>
<ul>
<li>Options: 2019, 2020, 2021, 2022.</li>
</ul></li>
<li><p><strong>Classification Method</strong>: Choose a method for classifying PCI values on the map.</p>
<ul>
<li><p>Options: <code>cont</code>, <code>equal</code>, <code>pretty</code>, <code>quantile</code>, <code>kmeans</code>, <code>hclust</code>, <code>bclust</code>, <code>fisher</code>, <code>jenks</code>.</p></li>
<li><p>This dropdown lets users choose the classification method for dividing the data into classes or intervals.</p></li>
</ul></li>
<li><p><strong>Number of Classes</strong>: Set the number of classification levels (between 5 and 10) for the PCI values.</p>
<ul>
<li>A slider allows the user to set the number of data classes, which are the ranges into which the data is divided for color-coding on the map</li>
</ul></li>
<li><p><strong>Colour Scheme</strong>: Select a color scheme to visualize PCI hotspots and cold spots.</p>
<ul>
<li><p>Options: Blues, Reds, Greens, Yellow-Orange-Red, Yellow-Orange-Brown, Yellow-Green, Orange-Red.</p></li>
<li><p>Users can choose a color scheme to represent different classes on the map.</p></li>
</ul></li>
<li><p><strong>Level of Transparency</strong>: Adjust the map’s opacity for better visual contrast (range: 0 to 1).</p>
<ul>
<li>This slider controls the transparency of the map layer, with a scale from 0 (fully transparent) to 1 (fully opaque).</li>
</ul></li>
</ol>
<p><img src="images/photo_2024-11-10_20-32-08.jpg" class="img-fluid"></p>
<p>The Main Panel displays the results based on the selected calibration inputs</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>The Gi* hotspot map highlights significant PCI hotspots (high PCI clusters) and cold spots (low PCI clusters) across provinces for the selected year.</p>
<p><img src="images/photo_2024-11-10_20-32-08-01.jpg" class="img-fluid"></p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="fdi-spatial-pattern-analysis-and-hotspots-analysis" class="level2">
<h2 class="anchored" data-anchor-id="fdi-spatial-pattern-analysis-and-hotspots-analysis"><strong>FDI Spatial Pattern Analysis and Hotspots Analysis</strong></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Local Moran of FDI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Gi Hotspot Analysis of FDI*</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Emerging Hotspot Analysis of FDI</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>This section displays the LISA map, which highlights local clusters and spatial outliers based on Local Moran’s I statistic.</p>
<ol type="1">
<li><p><strong>Mapping Variable (Year)</strong>: Select the FDI category to analyze.</p>
<ul>
<li><p>Options are dynamically populated based on available data</p>
<ul>
<li><p>T1: Total Projects</p></li>
<li><p>T2: Total Registered Capital</p></li>
</ul></li>
</ul></li>
<li><p><strong>Contiguity Method</strong>: Choose the spatial contiguity method.</p>
<ul>
<li><p>Options: <code>Queen</code> (default) or <code>Rook</code>.</p></li>
<li><p>“Queen” considers all surrounding areas as neighbors, while “Rook” only considers those sharing borders. Selecting the appropriate method affects which areas are considered spatially related, impacting the detection of clusters or patterns.</p></li>
</ul></li>
<li><p><strong>Spatial Weights Style</strong>: Select a weighting style for spatial association.</p>
<ul>
<li><p>Options: <code>W</code> (Row standardized), <code>B</code> (Binary), <code>C</code> (Globally standardized), <code>U</code> (C / number of neighbors), <code>minmax</code>, <code>S</code> (Variance).</p></li>
<li><p>This setting ensures that neighboring areas are weighted consistently, making the spatial correlation measures more meaningful and comparable across regions.</p></li>
</ul></li>
<li><p><strong>Number of Simulations</strong>: Set the number of simulations for significance testing (between 99 and 499).</p>
<ul>
<li>Users can adjust this based on the desired balance between accuracy and computational time.</li>
</ul></li>
<li><p><strong>Confidence Level</strong>: Select the confidence level for the LISA significance results.</p>
<ul>
<li><p>Options: 95% (0.05) or 99% (0.01).</p></li>
<li><p>A higher confidence level (e.g., 99%) reduces the chance of false positives, ensuring the detected patterns are statistically reliable.</p></li>
</ul></li>
<li><p><strong>LISA Classification</strong>: Select a classification method for the LISA clusters.</p>
<ul>
<li><p>Options: <code>mean</code>, <code>median</code>, <code>pysal</code>.</p></li>
<li><p>This affects the interpretation of clusters (e.g., high-high or low-low areas) and helps customize the analysis to specific policy or research needs.</p></li>
</ul></li>
<li><p><strong>Local Moran’s Statistic</strong>: Choose the type of Local Moran’s statistic to display.</p>
<ul>
<li>Options: <code>local moran(ii)</code>, <code>expectation(eii)</code>, <code>variance(var_ii)</code>, <code>std deviation(z_ii)</code>, <code>P-value</code></li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/photo_2024-11-10_20-32-05-01.jpg" class="img-fluid figure-img"></p>
<figcaption>The Main Panel displays the results based on the selected calibration inputs:</figcaption>
</figure>
</div>
<p><strong>Local Moran of FDI</strong>: The LISA map shows spatial clusters of similar total projects and total registered capitals levels and outliers, indicating local dependencies or deviations.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>In this section, users can view the Gi* hotspot map, which identifies spatial clusters of high and low FDI values.</p>
<ol type="1">
<li><p><strong>Mapping Variable (Year)</strong>: Select the FDI category to analyze.</p>
<ul>
<li>Options: Total Projects and Total registered capital</li>
</ul></li>
<li><p><strong>Classification Method</strong>: Choose a method for classifying PCI values on the map.</p>
<ul>
<li><p>Options: <code>cont</code>, <code>equal</code>, <code>pretty</code>, <code>quantile</code>, <code>kmeans</code>, <code>hclust</code>, <code>bclust</code>, <code>fisher</code>, <code>jenks</code>.</p></li>
<li><p>This dropdown lets users choose the classification method for dividing the data into classes or intervals.</p></li>
</ul></li>
<li><p><strong>Number of Classes</strong>: Set the number of classification levels (between 5 and 10) for the PCI values.</p>
<ul>
<li>A slider allows the user to set the number of data classes, which are the ranges into which the data is divided for color-coding on the map</li>
</ul></li>
<li><p><strong>Colour Scheme</strong>: Select a color scheme to visualize PCI hotspots and cold spots.</p>
<ul>
<li><p>Options: Blues, Reds, Greens, Yellow-Orange-Red, Yellow-Orange-Brown, Yellow-Green, Orange-Red.</p></li>
<li><p>Users can choose a color scheme to represent different classes on the map.</p></li>
</ul></li>
<li><p><strong>Level of Transparency</strong>: Adjust the map’s opacity for better visual contrast (range: 0 to 1).</p>
<ul>
<li>This slider controls the transparency of the map layer, with a scale from 0 (fully transparent) to 1 (fully opaque).</li>
</ul></li>
</ol>
<p><img src="images/photo_2024-11-10_20-32-10.jpg" class="img-fluid"></p>
<p>The Main Panel displays the results based on the selected calibration inputs</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>The Gi* hotspot map highlights significant FDI category hotspots (high PCI clusters) and cold spots (low PCI clusters) across provinces for the selected year.</p>
<p><img src="images/clipboard-4031888003.png" class="img-fluid"></p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="global-explanatory-model" class="level2">
<h2 class="anchored" data-anchor-id="global-explanatory-model"><strong>Global Explanatory Model</strong></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Multiple Linear Regression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Stepwise Model Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Visualise Model Parameter</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<section id="step-by-step-instructions" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-instructions">Step-by-Step Instructions</h4>
<ol type="1">
<li><p><strong>Select an FDI Measure</strong>:</p>
<ul>
<li>Use the tabs at the top to choose between <strong>Total Number of Projects</strong> or <strong>Total Registered Capital</strong> as the FDI measure you want to analyze.</li>
</ul></li>
<li><p><strong>Choose PCI Factors</strong>:</p>
<ul>
<li>In the left panel, you’ll find a list of available PCI factors (such as Entry Costs, Transparency, etc.). Select any combination of these factors to include in your customized model.</li>
</ul></li>
<li><p><strong>Update the Plot</strong>:</p>
<ul>
<li>Once you’ve made your PCI factor selections, click the <strong>Update Plot</strong> button to run the model with your chosen factors and refresh the results.</li>
</ul></li>
<li><p><strong>View the Results</strong>:</p>
<ul>
<li><p>The results are displayed in two main sections:</p>
<ul>
<li><p><strong>Model Summary</strong> (Left Panel): This panel provides an overall summary of the model, including performance metrics like Adjusted R², to show how well the model explains the variation in FDI based on the selected factors.</p></li>
<li><p><strong>Factor Contribution</strong> (Right Panel): This table displays detailed coefficient estimates for each selected factor, showing their individual contributions and significance within the model.</p></li>
</ul></li>
</ul></li>
</ol>
</section>
<section id="tips-for-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="tips-for-interpretation">Tips for Interpretation</h4>
<ul>
<li><p><strong>Adjusted R²</strong>: Look at this metric in the Model Summary panel to gauge how well your selected PCI factors explain variations in FDI.</p></li>
<li><p><strong>Factor Contribution Table</strong>: Higher coefficients indicate a stronger impact of the factor on FDI. Positive values suggest a positive influence on FDI, while negative values suggest a negative influence.</p></li>
</ul>
<p><img src="images/photo_2024-11-13_22-38-45.jpg" class="img-fluid"></p>
</section>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<section id="step-by-step-instructions-1" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-instructions-1">Step-by-Step Instructions</h4>
<ol type="1">
<li><p><strong>Select an FDI Measure</strong>:</p>
<ul>
<li>Use the tabs at the top to choose between <strong>Total Number of Projects</strong> or <strong>Total Registered Capital</strong> as the FDI measure you want to analyze.</li>
</ul></li>
<li><p><strong>Choose a Stepwise Approach</strong>:</p>
<ul>
<li><p>In the left panel, select one of the three stepwise methods:</p>
<ul>
<li><p><strong>Forward</strong>: Adds PCI factors one at a time based on their significance.</p></li>
<li><p><strong>Backward</strong>: Removes less significant PCI factors step-by-step.</p></li>
<li><p><strong>Both</strong>: Combines forward and backward selection to find the best balance of factors.</p></li>
</ul></li>
<li><p>Additionally, select a <strong>Confidence Level</strong> for the chosen approach to set the threshold for including/excluding factors in the model.</p></li>
</ul></li>
<li><p><strong>Generate Results</strong>:</p>
<ul>
<li><p>After selecting the approach and confidence level, click the <strong>Update Plot</strong> button to display the results.</p></li>
<li><p>The results include:</p>
<ul>
<li><p><strong>Summary Table</strong> (Right Panel): A breakdown of model metrics and selected factors.</p></li>
<li><p><strong>Plot</strong>: A visual summary of how each approach affects the model’s performance.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Compare Stepwise Approaches Using the Radar Chart</strong>:</p>
<ul>
<li><p><strong>Bottom Left Panel</strong>: Here, you can compare how each approach performs by selecting <strong>Forward</strong>, <strong>Backward</strong>, and/or <strong>Both</strong> for comparison.</p></li>
<li><p>Set a <strong>Confidence Level</strong> for this comparison.</p></li>
<li><p>Click <strong>Update Radar Chart</strong> to generate the radar chart.</p></li>
</ul></li>
<li><p><strong>Interpret the Radar Chart</strong>:</p>
<ul>
<li>The radar chart (Right Panel) provides a side-by-side view of model performance across the selected stepwise approaches, helping you see which approach and confidence level best captures the relationship between PCI factors and FDI.</li>
</ul></li>
</ol>
</section>
<section id="tips-for-interpretation-1" class="level4">
<h4 class="anchored" data-anchor-id="tips-for-interpretation-1">Tips for Interpretation</h4>
<ul>
<li><p><strong>Summary Table</strong>: Higher R² values or lower AIC/BIC scores in the table indicate a better-fitting model for each stepwise method.</p></li>
<li><p><strong>Radar Chart</strong>: A wider spread in the radar chart suggests better model performance. Compare across approaches to see which selection method aligns best with your confidence level.</p></li>
</ul>
<p><img src="images/Screenshot 2024-11-13 225534.png" class="img-fluid"></p>
</section>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<section id="step-by-step-instructions-2" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-instructions-2">Step-by-Step Instructions</h4>
<ol type="1">
<li><p><strong>Select an FDI Measure</strong>:</p>
<ul>
<li>Begin by selecting either <strong>Total Number of Projects</strong> or <strong>Total Registered Capital</strong> from the tabs at the top to choose the FDI metric you want to examine.</li>
</ul></li>
<li><p><strong>Choose a Stepwise Approach and Confidence Level</strong>:</p>
<ul>
<li><p>In the left panel, select one of the following stepwise approaches to refine the model:</p>
<ul>
<li><p><strong>Forward</strong>: Adds factors based on significance.</p></li>
<li><p><strong>Backward</strong>: Removes less significant factors step-by-step.</p></li>
<li><p><strong>Both</strong>: Balances forward and backward selection.</p></li>
</ul></li>
<li><p>Set a <strong>Confidence Level</strong> to control the threshold for including or excluding PCI factors in the model.</p></li>
</ul></li>
<li><p><strong>Generate the Plot</strong>:</p>
<ul>
<li><p>Once you’ve selected your approach and confidence level, click <strong>Update Plot</strong> to view the results.</p></li>
<li><p>The results will display on the right panel, where each PCI factor’s influence is shown:</p>
<ul>
<li><p><strong>Longer Lines</strong> indicate greater variation for that factor.</p></li>
<li><p><strong>Rightward Positions</strong> represent positive autocorrelation, suggesting that increases in this factor are positively correlated with the FDI metric.</p></li>
<li><p><strong>Leftward Positions</strong> represent negative autocorrelation, showing a negative relationship with FDI.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Sort Results</strong>:</p>
<ul>
<li>To view factors in <strong>Ascending</strong> or <strong>Descending</strong> order by impact, use the sort feature in the left panel. This can help you prioritize which PCI factors have the most or least influence on FDI based on your analysis.</li>
</ul></li>
</ol>
<p><img src="images/image_2024-11-13_23-08-43.png" class="img-fluid"></p>
</section>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="local-explanatory-model" class="level2">
<h2 class="anchored" data-anchor-id="local-explanatory-model"><strong>Local Explanatory Model</strong></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Bandwidth Comparison</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Visualise Local R2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Visualise Coefficient Estimates</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<section id="step-by-step-instructions-3" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-instructions-3">Step-by-Step Instructions</h4>
<ol type="1">
<li><p><strong>Select an FDI Measure</strong>:</p>
<ul>
<li>At the top, navigate to either <strong>Total Number of Projects</strong> or <strong>Total Registered Capital</strong> to select the FDI measure you want to investigate.</li>
</ul></li>
<li><p><strong>Choose Bandwidth Approaches and Kernels</strong>:</p>
<ul>
<li><p>In the left panel, configure your <strong>Fixed</strong> and <strong>Adaptive</strong> bandwidth settings individually:</p>
<ul>
<li><p><strong>Bandwidth Approach</strong>: Select either <strong>Cross Validation</strong> or <strong>Akaike Information Criterion (AIC)</strong>. Each approach evaluates bandwidth differently, so trying both can help identify which fits best with your data.</p></li>
<li><p><strong>Kernel Type</strong>: For each bandwidth type, select a kernel function from the options:</p>
<ul>
<li><p><strong>Gaussian</strong>: Applies a normal distribution weight.</p></li>
<li><p><strong>Exponential</strong>: Prioritizes nearby values, tapering with distance.</p></li>
<li><p><strong>Bisquare</strong>: Gives weight within a defined radius, tapering sharply beyond it.</p></li>
<li><p><strong>Tricube</strong>: Similar to Bisquare but with a smoother taper.</p></li>
<li><p><strong>Boxcar</strong>: Applies equal weight within a set distance.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>Generate the Comparison Plot</strong>:</p>
<ul>
<li><p>Once you’ve selected your bandwidth approach and kernel for both <strong>Fixed</strong> and <strong>Adaptive</strong> bandwidth types, click <strong>Update Plot</strong> to generate the visualization.</p></li>
<li><p>The resulting comparison plot will display on the right panel, with each bandwidth type side by side, letting you easily compare their effects.</p></li>
</ul></li>
</ol>
<p><img src="images/image_2024-11-13_23-15-06.png" class="img-fluid"></p>
</section>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<section id="step-by-step-instructions-4" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-instructions-4">Step-by-Step Instructions</h4>
<ol type="1">
<li><p><strong>Select an FDI Measure</strong>:</p>
<ul>
<li>Begin by navigating to either <strong>Total Number of Projects</strong> or <strong>Total Registered Capital</strong> at the top to specify the FDI measure for analysis.</li>
</ul></li>
<li><p><strong>Customize Bandwidth, Approach, and Kernel Settings</strong>:</p>
<ul>
<li><p>In the left panel, configure the Local R² model settings:</p>
<ul>
<li><p><strong>Bandwidth Type</strong>: Choose between <strong>Fixed</strong> and <strong>Adaptive</strong> to determine how bandwidth adjusts across the model:</p>
<ul>
<li><p><strong>Fixed</strong> applies the same bandwidth across all regions.</p></li>
<li><p><strong>Adaptive</strong> adjusts bandwidth based on regional density.</p></li>
</ul></li>
<li><p><strong>Approach</strong>: Select from <strong>Cross Validation</strong> or <strong>Akaike Information Criterion (AIC)</strong> to optimize the model fit.</p></li>
<li><p><strong>Kernel</strong>: Choose a kernel function to define how distances are weighted within the model:</p>
<ul>
<li><p><strong>Gaussian</strong>: Applies a normal distribution weight.</p></li>
<li><p><strong>Exponential</strong>: Gives more weight to closer points, tapering with distance.</p></li>
<li><p><strong>Bisquare</strong>: Applies weight within a set radius, dropping sharply beyond it.</p></li>
<li><p><strong>Tricube</strong>: Similar to Bisquare but tapers more smoothly.</p></li>
<li><p><strong>Boxcar</strong>: Assigns equal weight within a fixed distance.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>Generate the Local R² Map</strong>:</p>
<ul>
<li><p>Once you’ve selected the bandwidth, approach, and kernel, click <strong>Update Plot</strong> to generate the visualization.</p></li>
<li><p>The resulting map, displayed on the right, will show the Local R² values by province, allowing you to visually interpret where the model is performing well and where adjustments might be needed.</p></li>
</ul></li>
</ol>
<p><img src="images/image_2024-11-13_23-17-48.png" class="img-fluid"></p>
</section>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<section id="step-by-step-instructions-5" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-instructions-5">Step-by-Step Instructions</h4>
<ol type="1">
<li><p><strong>Select an FDI Measure</strong>:</p>
<ul>
<li>Begin by choosing <strong>Total Number of Projects</strong> or <strong>Total Registered Capital</strong> at the top to set the focus of the FDI analysis.</li>
</ul></li>
<li><p><strong>Configure Bandwidth, Approach, and Kernel Settings</strong>:</p>
<ul>
<li><p>In the left panel, set up the model specifications:</p>
<ul>
<li><p><strong>Bandwidth Type</strong>: Choose between <strong>Fixed</strong> and <strong>Adaptive</strong> for the bandwidth:</p>
<ul>
<li><p><strong>Fixed</strong> maintains the same bandwidth across all regions.</p></li>
<li><p><strong>Adaptive</strong> adjusts bandwidth according to regional density.</p></li>
</ul></li>
<li><p><strong>Approach</strong>: Pick either <strong>Cross Validation</strong> or <strong>Akaike Information Criterion (AIC)</strong> for model optimization.</p></li>
<li><p><strong>Kernel</strong>: Select a kernel function to define distance weighting:</p>
<ul>
<li><p><strong>Gaussian</strong>: Applies weights using a normal distribution.</p></li>
<li><p><strong>Exponential</strong>: Heavily weights closer points with a gradual tapering.</p></li>
<li><p><strong>Bisquare</strong>: Weights points within a fixed radius, tapering sharply outside.</p></li>
<li><p><strong>Tricube</strong>: Similar to Bisquare but with smoother tapering.</p></li>
<li><p><strong>Boxcar</strong>: Assigns equal weight within a fixed distance.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>Select Independent PCI Variables</strong>:</p>
<ul>
<li>Below the kernel setting, select the <strong>PCI factor</strong> (e.g., Entry Costs, Transparency) you wish to visualize. This choice will help focus on the specific impact of individual factors on the model.</li>
</ul></li>
<li><p><strong>Generate the Coefficient Estimates Visualization</strong>:</p>
<ul>
<li><p>After configuring the settings, click <strong>Update Plot</strong> to create the visualization.</p></li>
<li><p>The results will appear on the right side as a map, showing a side-by-side comparison of the <strong>Standard Error (SE)</strong> and <strong>TV</strong> for each province. This enables you to interpret the effect size and significance of each PCI factor locally.</p></li>
</ul></li>
</ol>
<p><img src="images/image_2024-11-13_23-21-43.png" class="img-fluid"></p>
</section>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>